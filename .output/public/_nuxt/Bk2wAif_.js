import{g as bt,j as X,r as M,c as p,o as x,a as f,k as Y,l as u,m as k,t as A,v as ot,n as Z,p as yt,F as at,q as wt,s as vt,x as St,y as Ct,z as Et,_ as Pt,b as W}from"./Cz4lFDg7.js";const Rt=" .,:;i1tfLCG08@",_t="@80GCLft1i;:,. ";function $t(e,t){const s=document.createElement("canvas");return s.width=e,s.height=t,s}function It(e,t,s){return Math.round(.299*e+.587*t+.114*s)}function kt(e,t,s){let n=(e-128)*t+128;return n=n*s,Math.max(0,Math.min(255,n))}const At=(e,t=.3,s=1,n=1,r=!1,o=!1,i=null)=>new Promise((a,l)=>{const d=new Image;d.crossOrigin="Anonymous",d.onload=()=>{try{const c=Math.floor(d.width*t),g=Math.floor(d.height*t*.5),C=$t(c,g).getContext("2d");if(!C){l(new Error("Could not get canvas context"));return}console.log(i),C.drawImage(d,0,0,c,g);const j=C.getImageData(0,0,c,g).data,_=r?_t:Rt,S=_.length-1,w=new Array(c*g),$=o?new Array(c*g):[];for(let b=0;b<g;b++)for(let y=0;y<c;y++){const D=(b*c+y)*4,[T,L,I]=[0,1,2].map(G=>kt(j[D+G],s,n)),B=It(T,L,I);w[b*c+y]=B,o&&($[b*c+y]=[T,L,I])}i&&i.dithering(w,c,g,S);let F="";for(let b=0;b<g;b++){for(let y=0;y<c;y++){const D=b*c+y,T=w[D],L=Math.min(_.length-1,Math.floor(T/255*S)),I=_[L];if(o){const[B,G,xt]=$[D];F+=`<span style="color: rgb(${Math.round(B)},${Math.round(G)},${Math.round(xt)})">${I}</span>`}else F+=I}F+=o?"<br>":`
`}a(F)}catch(c){l(c)}},d.onerror=()=>{l(new Error("Failed to load image"))},d.src=e});class Ft{dithering(t,s,n,r){const o=255/(r-1);for(let i=0;i<n;i++)for(let a=0;a<s;a++){const l=i*s+a,d=t[l],c=Math.round(d/o)*o;t[l]=c;const g=d-c;a+1<s&&(t[i*s+(a+1)]+=g*1/8),a+2<s&&(t[i*s+(a+2)]+=g*1/8),i+1<n&&a>0&&(t[(i+1)*s+(a-1)]+=g*1/8),i+1<n&&(t[(i+1)*s+a]+=g*1/8),i+1<n&&a+1<s&&(t[(i+1)*s+(a+1)]+=g*1/8),i+2<n&&(t[(i+2)*s+a]+=g*1/8)}for(let i=0;i<t.length;i++)t[i]=Math.max(0,Math.min(255,t[i]))}}class Dt{dithering(t,s,n,r){const o=255/(r-1);for(let i=0;i<n;i++)for(let a=0;a<s;a++){const l=i*s+a,d=t[l],c=Math.round(d/o)*o;t[l]=c;const g=d-c;a+1<s&&(t[i*s+(a+1)]+=g*7/16),i+1<n&&a>0&&(t[(i+1)*s+(a-1)]+=g*3/16),i+1<n&&(t[(i+1)*s+a]+=g*5/16),i+1<n&&a+1<s&&(t[(i+1)*s+(a+1)]+=g*1/16)}for(let i=0;i<t.length;i++)t[i]=Math.max(0,Math.min(255,t[i]))}}class Tt{dithering(t,s,n,r){const o=255/(r-1),i=new Array(n*s).fill(!1);let a=0;const l=[[0,1],[1,0],[0,-1],[-1,0],[1,1],[1,-1],[-1,-1],[-1,1]];let d=0,c=0;i[d*s+c]=!0;for(let g=0;g<n*s;g++){const R=d*s+c,C=t[R]+a,O=Math.round(C/o)*o;a=C-O,t[R]=O;for(const[j,_]of l){const S=d+j,w=c+_,$=S*s+w;if(S>=0&&S<n&&w>=0&&w<s&&!i[$]){d=S,c=w,i[$]=!0;break}}}for(let g=0;g<t.length;g++)t[g]=Math.max(0,Math.min(255,t[g]))}}const Lt=[{value:"none",label:"No Dithering"},{value:"atkinson",label:"Atkinson"},{value:"floyd-steinberg",label:"Floyd-Steinberg"},{value:"riemersma",label:"Riemersma"}];function Mt(e){switch(e){case"atkinson":return new Ft;case"floyd-steinberg":return new Dt;case"riemersma":return new Tt;case"none":return null;default:return null}}const K=bt("ascii",{state:()=>({imageData:null,asciiArt:"",coloredAscii:!1,resolution:.3,contrast:1,brightness:1,inverted:!1,isProcessing:!1,ditheringStrategy:"none"}),actions:{async setImage(e){this.imageData=e,await this.generateAscii()},async generateAscii(){if(this.imageData){this.isProcessing=!0;try{const e=Mt(this.ditheringStrategy);this.asciiArt=await At(this.imageData,this.resolution,this.contrast,this.brightness,this.inverted,this.coloredAscii,e)}catch(e){console.error("Error generating ASCII art:",e)}finally{this.isProcessing=!1}}}}}),Ut={class:"card p-5"},Vt={key:0,class:"space-y-4"},Ht=["src"],Ot={key:1,class:"py-8 space-y-2"},jt=X({__name:"ImageUploader",setup(e){const t=K(),s=M(null);function n(){var a;(a=s.value)==null||a.click()}function r(a){var d;const l=a.target;(d=l.files)!=null&&d[0]&&i(l.files[0])}function o(a){var d;const l=(d=a.dataTransfer)==null?void 0:d.files[0];l&&i(l)}function i(a){const l=new FileReader;l.onload=d=>{var g;const c=(g=d.target)==null?void 0:g.result;typeof c=="string"&&t.setImage(c)},l.readAsDataURL(a)}return(a,l)=>(x(),p("div",Ut,[l[4]||(l[4]=f("h2",{class:"text-xl font-semibold mb-4 text-lavender"},"Upload Image",-1)),f("div",{class:"border-2 border-dashed border-surface2 rounded-lg p-6 text-center cursor-pointer transition-colors hover:border-mauve",onClick:n,onKeydown:l[0]||(l[0]=d=>d.key==="Enter"&&n()),onDrop:Y(o,["prevent"]),onDragover:l[1]||(l[1]=Y(()=>{},["prevent"]))},[f("input",{type:"file",ref_key:"fileInput",ref:s,class:"hidden",accept:"image/*",onChange:r},null,544),u(t).imageData?(x(),p("div",Vt,[f("img",{src:u(t).imageData,alt:"Uploaded content",class:"max-h-48 mx-auto object-contain rounded-sm"},null,8,Ht),l[2]||(l[2]=f("p",{class:"text-subtext0"},"Click or drag to replace",-1))])):(x(),p("div",Ot,l[3]||(l[3]=[f("div",{class:"text-4xl text-mauve mb-2"},"@",-1),f("p",{class:"text-subtext0"},"Click to select or drag an image here",-1),f("p",{class:"text-sm text-overlay0"},"Supports JPG, PNG, GIF, etc.",-1)])))],32)]))}}),Bt={class:"card p-5"},Gt={class:"space-y-6 md:space-y-5"},Wt={class:"flex items-center justify-between mb-2",for:"resolution"},zt={class:"text-sm text-overlay1"},qt=["disabled"],Xt={class:"flex items-center justify-between mb-2",for:"contrast"},Kt={class:"text-sm text-overlay1"},Jt=["value","disabled"],Qt={class:"flex items-center justify-between mb-2",for:"brightness"},Yt={class:"text-sm text-overlay1"},Zt=["value","disabled"],Nt={class:"flex items-center space-x-3"},te=["disabled"],ee={class:"flex items-center space-x-3"},ne=["disabled"],se=["disabled"],re=["value"],ie=X({__name:"SettingsPanel",setup(e){const t=K();return(s,n)=>(x(),p("div",Bt,[n[20]||(n[20]=f("h2",{class:"text-xl font-semibold mb-4 text-lavender"},"Settings",-1)),f("div",Gt,[f("div",null,[f("label",Wt,[n[12]||(n[12]=f("span",{class:"text-subtext0"},"Resolution",-1)),f("span",zt,A(Math.round(u(t).resolution*100))+"% ",1)]),k(f("input",{id:"resolution",type:"range",min:"0.1",max:"1",step:"0.05","onUpdate:modelValue":n[0]||(n[0]=r=>u(t).resolution=r),onChange:n[1]||(n[1]=(...r)=>u(t).generateAscii&&u(t).generateAscii(...r)),class:"w-full",disabled:u(t).isProcessing},null,40,qt),[[ot,u(t).resolution]]),n[13]||(n[13]=f("p",{class:"text-xs text-overlay0 mt-1"}," Higher values create more detailed ASCII art ",-1))]),f("div",null,[f("label",Xt,[n[14]||(n[14]=f("span",{class:"text-subtext0"},"Contrast",-1)),f("span",Kt,A(u(t).contrast.toFixed(1))+"x ",1)]),f("input",{id:"contrast",type:"range",min:"0.5",max:"2",step:"0.1",value:u(t).contrast,onInput:n[2]||(n[2]=r=>u(t).contrast=Number(r.target.value)),onChange:n[3]||(n[3]=(...r)=>u(t).generateAscii&&u(t).generateAscii(...r)),class:"w-full",disabled:u(t).isProcessing},null,40,Jt)]),f("div",null,[f("label",Qt,[n[15]||(n[15]=f("span",{class:"text-subtext0"},"Brightness",-1)),f("span",Yt,A(u(t).brightness.toFixed(1))+"x ",1)]),f("input",{id:"brightness",type:"range",min:"0.5",max:"2",step:"0.1",value:u(t).brightness,onInput:n[4]||(n[4]=r=>u(t).brightness=Number(r.target.value)),onChange:n[5]||(n[5]=(...r)=>u(t).generateAscii&&u(t).generateAscii(...r)),class:"w-full",disabled:u(t).isProcessing},null,40,Zt)]),f("div",Nt,[k(f("input",{type:"checkbox",id:"inverted","onUpdate:modelValue":n[6]||(n[6]=r=>u(t).inverted=r),onChange:n[7]||(n[7]=(...r)=>u(t).generateAscii&&u(t).generateAscii(...r)),class:"checkbox-input",disabled:u(t).isProcessing},null,40,te),[[Z,u(t).inverted]]),n[16]||(n[16]=f("label",{for:"inverted",class:"text-subtext0"}," Invert colors ",-1))]),f("div",ee,[k(f("input",{type:"checkbox",id:"colored","onUpdate:modelValue":n[8]||(n[8]=r=>u(t).coloredAscii=r),onChange:n[9]||(n[9]=(...r)=>u(t).generateAscii&&u(t).generateAscii(...r)),class:"checkbox-input",disabled:u(t).isProcessing},null,40,ne),[[Z,u(t).coloredAscii]]),n[17]||(n[17]=f("label",{for:"colored",class:"text-subtext0"}," Colored output ",-1))]),f("div",null,[n[18]||(n[18]=f("label",{for:"dithering",class:"text-subtext0"},"Dithering ",-1)),k(f("select",{id:"dithering","onUpdate:modelValue":n[10]||(n[10]=r=>u(t).ditheringStrategy=r),onChange:n[11]||(n[11]=(...r)=>u(t).generateAscii&&u(t).generateAscii(...r)),class:"select-input",disabled:u(t).isProcessing},[(x(!0),p(at,null,wt(u(Lt),r=>(x(),p("option",{key:r.value,value:r.value},A(r.label),9,re))),128))],40,se),[[yt,u(t).ditheringStrategy]]),n[19]||(n[19]=f("p",{class:"text-xs text-overlay0 mt-1"}," Dithering can improve the appearance of the ASCII art by reducing banding. ",-1))])])]))}});function oe(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const s=document.implementation.createHTMLDocument(),n=s.createElement("base"),r=s.createElement("a");return s.head.appendChild(n),s.body.appendChild(r),t&&(n.href=t),r.href=e,r.href}const ae=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function v(e){const t=[];for(let s=0,n=e.length;s<n;s++)t.push(e[s]);return t}let E=null;function lt(e={}){return E||(e.includeStyleProperties?(E=e.includeStyleProperties,E):(E=v(window.getComputedStyle(document.documentElement)),E))}function U(e,t){const n=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return n?parseFloat(n.replace("px","")):0}function le(e){const t=U(e,"border-left-width"),s=U(e,"border-right-width");return e.clientWidth+t+s}function ce(e){const t=U(e,"border-top-width"),s=U(e,"border-bottom-width");return e.clientHeight+t+s}function ct(e,t={}){const s=t.width||le(e),n=t.height||ce(e);return{width:s,height:n}}function ue(){let e,t;try{t=process}catch{}const s=t&&t.env?t.env.devicePixelRatio:null;return s&&(e=parseInt(s,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const h=16384;function fe(e){(e.width>h||e.height>h)&&(e.width>h&&e.height>h?e.width>e.height?(e.height*=h/e.width,e.width=h):(e.width*=h/e.height,e.height=h):e.width>h?(e.height*=h/e.width,e.width=h):(e.width*=h/e.height,e.height=h))}function V(e){return new Promise((t,s)=>{const n=new Image;n.onload=()=>{n.decode().then(()=>{requestAnimationFrame(()=>t(n))})},n.onerror=s,n.crossOrigin="anonymous",n.decoding="async",n.src=e})}async function de(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function ge(e,t,s){const n="http://www.w3.org/2000/svg",r=document.createElementNS(n,"svg"),o=document.createElementNS(n,"foreignObject");return r.setAttribute("width",`${t}`),r.setAttribute("height",`${s}`),r.setAttribute("viewBox",`0 0 ${t} ${s}`),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("externalResourcesRequired","true"),r.appendChild(o),o.appendChild(e),de(r)}const m=(e,t)=>{if(e instanceof t)return!0;const s=Object.getPrototypeOf(e);return s===null?!1:s.constructor.name===t.name||m(s,t)};function me(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function he(e,t){return lt(t).map(s=>{const n=e.getPropertyValue(s),r=e.getPropertyPriority(s);return`${s}: ${n}${r?" !important":""};`}).join(" ")}function pe(e,t,s,n){const r=`.${e}:${t}`,o=s.cssText?me(s):he(s,n);return document.createTextNode(`${r}{${o}}`)}function N(e,t,s,n){const r=window.getComputedStyle(e,s),o=r.getPropertyValue("content");if(o===""||o==="none")return;const i=ae();try{t.className=`${t.className} ${i}`}catch{return}const a=document.createElement("style");a.appendChild(pe(i,s,r,n)),t.appendChild(a)}function xe(e,t,s){N(e,t,":before",s),N(e,t,":after",s)}const tt="application/font-woff",et="image/jpeg",be={woff:tt,woff2:tt,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:et,jpeg:et,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function ye(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function J(e){const t=ye(e).toLowerCase();return be[t]||""}function we(e){return e.split(/,/)[1]}function q(e){return e.search(/^(data:)/)!==-1}function ve(e,t){return`data:${t};base64,${e}`}async function ut(e,t,s){const n=await fetch(e,t);if(n.status===404)throw new Error(`Resource "${n.url}" not found`);const r=await n.blob();return new Promise((o,i)=>{const a=new FileReader;a.onerror=i,a.onloadend=()=>{try{o(s({res:n,result:a.result}))}catch(l){i(l)}},a.readAsDataURL(r)})}const z={};function Se(e,t,s){let n=e.replace(/\?.*/,"");return s&&(n=e),/ttf|otf|eot|woff2?/i.test(n)&&(n=n.replace(/.*\//,"")),t?`[${t}]${n}`:n}async function Q(e,t,s){const n=Se(e,t,s.includeQueryParams);if(z[n]!=null)return z[n];s.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let r;try{const o=await ut(e,s.fetchRequestInit,({res:i,result:a})=>(t||(t=i.headers.get("Content-Type")||""),we(a)));r=ve(o,t)}catch(o){r=s.imagePlaceholder||"";let i=`Failed to fetch resource: ${e}`;o&&(i=typeof o=="string"?o:o.message),i&&console.warn(i)}return z[n]=r,r}async function Ce(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):V(t)}async function Ee(e,t){if(e.currentSrc){const o=document.createElement("canvas"),i=o.getContext("2d");o.width=e.clientWidth,o.height=e.clientHeight,i==null||i.drawImage(e,0,0,o.width,o.height);const a=o.toDataURL();return V(a)}const s=e.poster,n=J(s),r=await Q(s,n,t);return V(r)}async function Pe(e,t){var s;try{if(!((s=e==null?void 0:e.contentDocument)===null||s===void 0)&&s.body)return await H(e.contentDocument.body,t,!0)}catch{}return e.cloneNode(!1)}async function Re(e,t){return m(e,HTMLCanvasElement)?Ce(e):m(e,HTMLVideoElement)?Ee(e,t):m(e,HTMLIFrameElement)?Pe(e,t):e.cloneNode(ft(e))}const _e=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",ft=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function $e(e,t,s){var n,r;if(ft(t))return t;let o=[];return _e(e)&&e.assignedNodes?o=v(e.assignedNodes()):m(e,HTMLIFrameElement)&&(!((n=e.contentDocument)===null||n===void 0)&&n.body)?o=v(e.contentDocument.body.childNodes):o=v(((r=e.shadowRoot)!==null&&r!==void 0?r:e).childNodes),o.length===0||m(e,HTMLVideoElement)||await o.reduce((i,a)=>i.then(()=>H(a,s)).then(l=>{l&&t.appendChild(l)}),Promise.resolve()),t}function Ie(e,t,s){const n=t.style;if(!n)return;const r=window.getComputedStyle(e);r.cssText?(n.cssText=r.cssText,n.transformOrigin=r.transformOrigin):lt(s).forEach(o=>{let i=r.getPropertyValue(o);o==="font-size"&&i.endsWith("px")&&(i=`${Math.floor(parseFloat(i.substring(0,i.length-2)))-.1}px`),m(e,HTMLIFrameElement)&&o==="display"&&i==="inline"&&(i="block"),o==="d"&&t.getAttribute("d")&&(i=`path(${t.getAttribute("d")})`),n.setProperty(o,i,r.getPropertyPriority(o))})}function ke(e,t){m(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),m(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function Ae(e,t){if(m(e,HTMLSelectElement)){const s=t,n=Array.from(s.children).find(r=>e.value===r.getAttribute("value"));n&&n.setAttribute("selected","")}}function Fe(e,t,s){return m(t,Element)&&(Ie(e,t,s),xe(e,t,s),ke(e,t),Ae(e,t)),t}async function De(e,t){const s=e.querySelectorAll?e.querySelectorAll("use"):[];if(s.length===0)return e;const n={};for(let o=0;o<s.length;o++){const a=s[o].getAttribute("xlink:href");if(a){const l=e.querySelector(a),d=document.querySelector(a);!l&&d&&!n[a]&&(n[a]=await H(d,t,!0))}}const r=Object.values(n);if(r.length){const o="http://www.w3.org/1999/xhtml",i=document.createElementNS(o,"svg");i.setAttribute("xmlns",o),i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.overflow="hidden",i.style.display="none";const a=document.createElementNS(o,"defs");i.appendChild(a);for(let l=0;l<r.length;l++)a.appendChild(r[l]);e.appendChild(i)}return e}async function H(e,t,s){return!s&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(n=>Re(n,t)).then(n=>$e(e,n,t)).then(n=>Fe(e,n,t)).then(n=>De(n,t))}const dt=/url\((['"]?)([^'"]+?)\1\)/g,Te=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,Le=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function Me(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function Ue(e){const t=[];return e.replace(dt,(s,n,r)=>(t.push(r),s)),t.filter(s=>!q(s))}async function Ve(e,t,s,n,r){try{const o=s?oe(t,s):t,i=J(t);let a;return r||(a=await Q(o,i,n)),e.replace(Me(t),`$1${a}$3`)}catch{}return e}function He(e,{preferredFontFormat:t}){return t?e.replace(Le,s=>{for(;;){const[n,,r]=Te.exec(s)||[];if(!r)return"";if(r===t)return`src: ${n};`}}):e}function gt(e){return e.search(dt)!==-1}async function mt(e,t,s){if(!gt(e))return e;const n=He(e,s);return Ue(n).reduce((o,i)=>o.then(a=>Ve(a,i,t,s)),Promise.resolve(n))}async function P(e,t,s){var n;const r=(n=t.style)===null||n===void 0?void 0:n.getPropertyValue(e);if(r){const o=await mt(r,null,s);return t.style.setProperty(e,o,t.style.getPropertyPriority(e)),!0}return!1}async function Oe(e,t){await P("background",e,t)||await P("background-image",e,t),await P("mask",e,t)||await P("-webkit-mask",e,t)||await P("mask-image",e,t)||await P("-webkit-mask-image",e,t)}async function je(e,t){const s=m(e,HTMLImageElement);if(!(s&&!q(e.src))&&!(m(e,SVGImageElement)&&!q(e.href.baseVal)))return;const n=s?e.src:e.href.baseVal,r=await Q(n,J(n),t);await new Promise((o,i)=>{e.onload=o,e.onerror=t.onImageErrorHandler?(...l)=>{try{o(t.onImageErrorHandler(...l))}catch(d){i(d)}}:i;const a=e;a.decode&&(a.decode=o),a.loading==="lazy"&&(a.loading="eager"),s?(e.srcset="",e.src=r):e.href.baseVal=r})}async function Be(e,t){const n=v(e.childNodes).map(r=>ht(r,t));await Promise.all(n).then(()=>e)}async function ht(e,t){m(e,Element)&&(await Oe(e,t),await je(e,t),await Be(e,t))}function Ge(e,t){const{style:s}=e;t.backgroundColor&&(s.backgroundColor=t.backgroundColor),t.width&&(s.width=`${t.width}px`),t.height&&(s.height=`${t.height}px`);const n=t.style;return n!=null&&Object.keys(n).forEach(r=>{s[r]=n[r]}),e}const nt={};async function st(e){let t=nt[e];if(t!=null)return t;const n=await(await fetch(e)).text();return t={url:e,cssText:n},nt[e]=t,t}async function rt(e,t){let s=e.cssText;const n=/url\(["']?([^"')]+)["']?\)/g,o=(s.match(/url\([^)]+\)/g)||[]).map(async i=>{let a=i.replace(n,"$1");return a.startsWith("https://")||(a=new URL(a,e.url).href),ut(a,t.fetchRequestInit,({result:l})=>(s=s.replace(i,`url(${l})`),[i,l]))});return Promise.all(o).then(()=>s)}function it(e){if(e==null)return[];const t=[],s=/(\/\*[\s\S]*?\*\/)/gi;let n=e.replace(s,"");const r=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const l=r.exec(n);if(l===null)break;t.push(l[0])}n=n.replace(r,"");const o=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,i="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",a=new RegExp(i,"gi");for(;;){let l=o.exec(n);if(l===null){if(l=a.exec(n),l===null)break;o.lastIndex=a.lastIndex}else a.lastIndex=o.lastIndex;t.push(l[0])}return t}async function We(e,t){const s=[],n=[];return e.forEach(r=>{if("cssRules"in r)try{v(r.cssRules||[]).forEach((o,i)=>{if(o.type===CSSRule.IMPORT_RULE){let a=i+1;const l=o.href,d=st(l).then(c=>rt(c,t)).then(c=>it(c).forEach(g=>{try{r.insertRule(g,g.startsWith("@import")?a+=1:r.cssRules.length)}catch(R){console.error("Error inserting rule from remote css",{rule:g,error:R})}})).catch(c=>{console.error("Error loading remote css",c.toString())});n.push(d)}})}catch(o){const i=e.find(a=>a.href==null)||document.styleSheets[0];r.href!=null&&n.push(st(r.href).then(a=>rt(a,t)).then(a=>it(a).forEach(l=>{i.insertRule(l,i.cssRules.length)})).catch(a=>{console.error("Error loading remote stylesheet",a)})),console.error("Error inlining remote css file",o)}}),Promise.all(n).then(()=>(e.forEach(r=>{if("cssRules"in r)try{v(r.cssRules||[]).forEach(o=>{s.push(o)})}catch(o){console.error(`Error while reading CSS rules from ${r.href}`,o)}}),s))}function ze(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>gt(t.style.getPropertyValue("src")))}async function qe(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const s=v(e.ownerDocument.styleSheets),n=await We(s,t);return ze(n)}function pt(e){return e.trim().replace(/["']/g,"")}function Xe(e){const t=new Set;function s(n){(n.style.fontFamily||getComputedStyle(n).fontFamily).split(",").forEach(o=>{t.add(pt(o))}),Array.from(n.children).forEach(o=>{o instanceof HTMLElement&&s(o)})}return s(e),t}async function Ke(e,t){const s=await qe(e,t),n=Xe(e);return(await Promise.all(s.filter(o=>n.has(pt(o.style.fontFamily))).map(o=>{const i=o.parentStyleSheet?o.parentStyleSheet.href:null;return mt(o.cssText,i,t)}))).join(`
`)}async function Je(e,t){const s=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await Ke(e,t);if(s){const n=document.createElement("style"),r=document.createTextNode(s);n.appendChild(r),e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n)}}async function Qe(e,t={}){const{width:s,height:n}=ct(e,t),r=await H(e,t,!0);return await Je(r,t),await ht(r,t),Ge(r,t),await ge(r,s,n)}async function Ye(e,t={}){const{width:s,height:n}=ct(e,t),r=await Qe(e,t),o=await V(r),i=document.createElement("canvas"),a=i.getContext("2d"),l=t.pixelRatio||ue(),d=t.canvasWidth||s,c=t.canvasHeight||n;return i.width=d*l,i.height=c*l,t.skipAutoScale||fe(i),i.style.width=`${d}`,i.style.height=`${c}`,t.backgroundColor&&(a.fillStyle=t.backgroundColor,a.fillRect(0,0,i.width,i.height)),a.drawImage(o,0,0,i.width,i.height),i}async function Ze(e,t={}){return(await Ye(e,t)).toDataURL()}const Ne={class:"card h-full flex flex-col"},tn={class:"p-5 border-b border-surface0 flex flex-wrap items-center justify-between gap-2"},en={class:"flex items-center space-x-2"},nn=["disabled"],sn=["disabled","title"],rn=["disabled"],on=["disabled"],an={class:"grow p-4 overflow-auto relative"},ln={key:0,class:"absolute inset-0 bg-base/80 flex items-center justify-center z-10 transition-all duration-300 ease-in-out"},cn={key:0,class:"ascii-container"},un=["innerHTML"],fn={key:1,class:"h-full flex flex-col items-center justify-center text-center p-6"},dn=X({__name:"AsciiOutput",setup(e){const t=K(),s=M(null),n=M(1),r=M(!1);function o(){r.value=document.fullscreenElement!==null}vt(()=>document.addEventListener("fullscreenchange",o)),St(()=>document.removeEventListener("fullscreenchange",o));async function i(){if(!(!s.value||!t.asciiArt))try{const d=await Ze(s.value,{backgroundColor:"#000000",style:{transform:"scale(1)",transformOrigin:"top left"}}),c=document.createElement("a");c.download="ascii-art.png",c.href=d,c.click()}catch(d){console.error("Error downloading image:",d)}}async function a(){if(!t.asciiArt)return;const d=new Blob([t.asciiArt],{type:"text/plain"}),c=URL.createObjectURL(d),g=document.createElement("a");g.download="ascii-art.txt",g.href=c,g.click(),URL.revokeObjectURL(c)}async function l(){s.value&&(document.fullscreenElement?await document.exitFullscreen():s.value.requestFullscreen().catch(d=>{console.error(`Error attempting to enable fullscreen: ${d.message}`)}))}return(d,c)=>(x(),p("div",Ne,[f("div",tn,[c[1]||(c[1]=f("h2",{class:"text-xl font-semibold text-lavender"},"ASCII Output",-1)),f("div",en,[k(f("input",{type:"range",min:"0.5",max:"2",step:"0.1","onUpdate:modelValue":c[0]||(c[0]=g=>Ct(n)?n.value=g:null),class:"w-24",title:"Adjust size",disabled:!u(t).asciiArt||u(t).isProcessing},null,8,nn),[[ot,u(n)]]),f("button",{type:"button",onClick:l,class:"btn",disabled:!u(t).asciiArt||u(t).isProcessing,title:u(r)?"Exit fullscreen":"Fullscreen"},A(u(r)?"Exit":"Fullscreen"),9,sn),f("button",{type:"button",onClick:i,class:"btn",disabled:!u(t).asciiArt||u(t).isProcessing,title:"Download as PNG"}," PNG ",8,rn),f("button",{type:"button",onClick:a,class:"btn",disabled:!u(t).asciiArt||u(t).isProcessing,title:"Download as Text"}," TXT ",8,on)])]),f("div",an,[u(t).isProcessing?(x(),p("div",ln,c[2]||(c[2]=[f("div",{class:"text-mauve text-lg"},"Processing...",-1)]))):(x(),p(at,{key:1},[u(t).asciiArt?(x(),p("div",cn,[f("div",{ref_key:"outputRef",ref:s,class:"ascii-output transition-all duration-300 ease-in-out",style:Et({transform:`scale(${u(n)})`,transformOrigin:"0 0",color:u(t).coloredAscii?void 0:"var(--text)",opacity:u(t).isProcessing?"0.5":"1"}),innerHTML:u(t).asciiArt},null,12,un)])):(x(),p("div",fn,c[3]||(c[3]=[f("div",{class:"text-4xl text-mauve mb-4"},"@",-1),f("p",{class:"text-subtext0 mb-2"},"Upload an image to generate the ASCII",-1),f("p",{class:"text-sm text-overlay0"},"Adjust the settings to customize the output",-1)])))],64))])]))}}),gn={},mn={class:"grow p-4 md:p-6 max-w-7xl mx-auto w-full"},hn={class:"grid grid-cols-1 lg:grid-cols-12 gap-6"},pn={class:"lg:col-span-4 space-y-6"},xn={class:"lg:col-span-8"};function bn(e,t){const s=jt,n=ie,r=dn;return x(),p("main",mn,[f("div",hn,[f("div",pn,[W(s),W(n)]),f("div",xn,[W(r)])])])}const wn=Pt(gn,[["render",bn]]);export{wn as default};
